<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="generator" content="Aspose.Words for .NET 26.2.0" /><title></title><style type="text/css">body { font-family:'Times New Roman'; font-size:12pt }p { margin:0pt }li { margin-top:0pt; margin-bottom:0pt }</style></head><body><div><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'">&lt;!doctype html&gt;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'">&lt;html lang="zh-TW" class="h-full"&gt;</span></p><p style="text-indent:6.3pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;head&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;meta charset="UTF-8"&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;title&gt;</span><span style="font-family:'Microsoft JhengHei'">輔導處智慧課表管理系統</span><span style="font-family:'Courier New'">&lt;/title&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;script src="/_sdk/element_sdk.js"&gt;&lt;/script&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;script src="/_sdk/data_sdk.js"&gt;&lt;/script&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;style&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">body {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-sizing: border-box;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin: 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-family: 'Microsoft JhengHei', 'Microsoft YaHei', Arial, sans-serif;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-height: 100%;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">height: 100%;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">height: 100%;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="margin-left:44.1pt; text-indent:-18.9pt; font-size:10.5pt; -aw-import:list-item; -aw-list-level-number:0; -aw-list-number-format:'*'; -aw-list-number-styles:'bullet'; -aw-list-padding-sml:12.6pt"><span style="-aw-import:ignore"><span style="font-family:'Courier New'"><span>*</span></span><span style="width:12.6pt; font:7pt 'Times New Roman'; display:inline-block; -aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span></span><span style="font-family:'Courier New'">{</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-sizing: border-box;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.app-container {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">max-width: 1600px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin: 0 auto;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-height: 100%;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 0 50px rgba(0,0,0,0.1);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 16px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.app-container.font-small {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 14px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.app-container.font-large {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 18px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.header {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 20px 30px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 25px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 5px 20px rgba(102,126,234,0.3);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.header-top {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: space-between;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-wrap: wrap;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 15px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.header-title {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 2em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin: 0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.header-controls {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-wrap: wrap;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.stats-container {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: rgba(255,255,255,0.25);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 10px 18px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">backdrop-filter: blur(10px);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.stat-item {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 8px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.stat-icon {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1.2em;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.stat-content {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-direction: column;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 2px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.stat-number {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1.2em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: rgba(255,255,255,0.4);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 3px 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 6px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">line-height: 1.2;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.stat-label {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.7em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">opacity: 0.95;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.font-size-controls {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 5px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: rgba(255,255,255,0.2);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 5px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">backdrop-filter: blur(10px);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.font-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: rgba(255,255,255,0.3);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid transparent;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 8px 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.85em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.font-btn:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: rgba(255,255,255,0.5);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.font-btn.active {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: white;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.login-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: rgba(255,255,255,0.3);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 8px 16px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.9em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.login-btn:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.login-btn.logged-in {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #10b981;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #10b981;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.nav-tabs {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-bottom: 3px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding-bottom: 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-wrap: wrap;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.nav-tab {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #f3f4f6;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 15px 30px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px 10px 0 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1.125em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #6b7280;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.nav-tab:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: translateY(-2px);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.nav-tab.active {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 -3px 10px rgba(102,126,234,0.3);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.nav-tab.admin-only {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: none;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.nav-tab.admin-only.visible {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: block;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.date-navigation {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: space-between;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 25px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #f9fafb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-wrap: wrap;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 15px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.date-controls {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-wrap: wrap;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.week-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 10px 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.week-btn:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #5568d3;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.week-btn:disabled {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #9ca3af;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: not-allowed;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: none;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.date-display {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1.125em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #1f2937;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 10px 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #667eea;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.admin-tools {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-wrap: wrap;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.admin-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 10px 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.9375em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.admin-btn:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.admin-btn:disabled {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #9ca3af;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #9ca3af;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: not-allowed;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: none;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.admin-btn.primary {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.admin-btn.primary:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #5568d3;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.admin-btn.danger {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #ef4444;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #ef4444;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.admin-btn.danger:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #ef4444;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-layout {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: flex-start;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-sidebar {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-width: 200px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 2px 15px rgba(0,0,0,0.1);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-sidebar.collapsed {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-width: 70px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 12px 8px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.sidebar-header {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: space-between;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding-bottom: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-bottom: 2px solid #e5e7eb;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.sidebar-title {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1.0625em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #1f2937;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.collapse-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #f3f4f6;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 32px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">height: 32px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-shrink: 0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.collapse-btn:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.1);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-list {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-direction: column;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 8px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-item {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #f9fafb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-item:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #f3f4f6;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: translateX(3px);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-color {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">height: 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 5px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-shrink: 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid rgba(0,0,0,0.1);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-name-text {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex: 1;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #1f2937;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.9em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-width: 0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-toggle-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #10b981;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 6px 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 6px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.75em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">white-space: nowrap;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-shrink: 0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-toggle-btn:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 3px 10px rgba(0,0,0,0.2);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-toggle-btn.hidden-state {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #9ca3af;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-sidebar.collapsed .teacher-name-text {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: none;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-sidebar.collapsed .teacher-toggle-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 6px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-sidebar.collapsed .sidebar-title {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: none;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-sidebar.collapsed .teacher-item {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-direction: column;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 6px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-main {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex: 1;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">overflow-x: auto;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 2px 15px rgba(0,0,0,0.1);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-table {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 100%;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-collapse: collapse;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-width: 700px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-table th,</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-table td {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">vertical-align: top;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 18%;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-table th.period-header,</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-table td:first-child {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 10%;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-table th {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">position: sticky;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">top: 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">z-index: 10;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-table th.period-header {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #f3f4f6;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #1f2937;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 80px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-width: 80px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">max-width: 80px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-table td {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-height: 70px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-badges-container {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-wrap: wrap;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: flex-start;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: stretch;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 100%;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-badge {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 10px 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.875em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #000;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex: 0 0 calc(50% - 4px);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-width: 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid rgba(0,0,0,0.1);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">position: relative;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">line-height: 1.5;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-direction: column;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: flex-start;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-badge.conflict {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">animation: conflictPulse 1.5s ease-in-out infinite;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-width: 3px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">@keyframes conflictPulse {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">0%, 100% {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #ef4444;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">50% {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #dc2626;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 0 0 6px rgba(239, 68, 68, 0);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.schedule-badge:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.02);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 2px 8px rgba(0,0,0,0.15);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.badge-teacher {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 4px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.badge-activity {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.9em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 2px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.badge-classroom {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.85em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">opacity: 0.9;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.badge-note {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.8em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">opacity: 0.85;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-style: italic;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-top: 2px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.badge-activity.training {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #1e40af;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.badge-activity.holiday {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #dc2626;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.simple-badge {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 8px 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.875em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #000;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex: 0 0 calc(50% - 4px);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-width: 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid rgba(0,0,0,0.1);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 5px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.simple-badge:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 2px 8px rgba(0,0,0,0.15);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.activity-buttons {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 6px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-top: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: flex-start;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.edit-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #3b82f6;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 5px 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 5px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.6875em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.edit-btn:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #2563eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.delete-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #ef4444;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 5px 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 5px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.6875em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.delete-btn:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #dc2626;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.support-badge {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 10px 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.875em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #000;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid rgba(0,0,0,0.1);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.support-badge:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 2px 8px rgba(0,0,0,0.15);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.all-support {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 10px 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.875em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #10b981;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #10b981;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #d1fae5;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.classroom-badge {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.875em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #000;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: left;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid rgba(0,0,0,0.1);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin: 4px 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">line-height: 1.6;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.classroom-badge:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.02);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 2px 8px rgba(0,0,0,0.15);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.classroom-name {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1.1em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 4px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.classroom-teacher {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.95em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 2px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.classroom-activity {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.85em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">opacity: 0.9;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.settings-container {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">max-width: 1200px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin: 0 auto;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 20px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.settings-section {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 30px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 30px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 2px 15px rgba(0,0,0,0.1);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.settings-section-title {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1.5em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #1f2937;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 25px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding-bottom: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-bottom: 3px solid #667eea;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.settings-form-group {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 25px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.settings-label {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: block;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #374151;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.settings-input {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 100%;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-family: 'Microsoft JhengHei', 'Microsoft YaHei', Arial, sans-serif;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.settings-input:focus {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">outline: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 0 0 3px rgba(102,126,234,0.1);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.config-list {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-direction: column;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-top: 20px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.config-item {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #f9fafb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-wrap: wrap;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.config-item:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 2px 10px rgba(0,0,0,0.08);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.config-item.new-slot {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-style: dashed;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #fefefe;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.color-preview {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 40px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">height: 40px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 3px solid rgba(0,0,0,0.1);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-shrink: 0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.config-name-input {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex: 1;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">min-width: 150px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-family: 'Microsoft JhengHei', 'Microsoft YaHei', Arial, sans-serif;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.config-name-input:focus {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">outline: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 0 0 3px rgba(102,126,234,0.1);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.color-picker-wrapper {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.color-picker {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 60px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">height: 40px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.color-picker:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #667eea;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.color-input {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 100px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.875em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-family: monospace;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.color-input:focus {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">outline: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 0 0 3px rgba(102,126,234,0.1);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.save-settings-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #10b981;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 14px 40px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-top: 10px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.save-settings-btn:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #059669;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 4px 15px rgba(16,185,129,0.3);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.save-settings-btn:disabled {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #9ca3af;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: not-allowed;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: none;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.activity-grid {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: grid;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-top: 20px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.activity-item {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #f9fafb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.activity-item:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 2px 10px rgba(0,0,0,0.08);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.activity-item.new-slot {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-style: dashed;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #fefefe;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.activity-input {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 100%;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 6px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.9375em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-family: 'Microsoft JhengHei', 'Microsoft YaHei', Arial, sans-serif;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.activity-input:focus {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">outline: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 0 0 3px rgba(102,126,234,0.1);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">position: fixed;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">top: 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">left: 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 100%;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">height: 100%;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: rgba(0,0,0,0.6);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">z-index: 1000;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">backdrop-filter: blur(5px);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal.active {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-content {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 30px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">max-width: 700px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 90%;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">max-height: 90%;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">overflow-y: auto;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 10px 40px rgba(0,0,0,0.3);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-header {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1.5em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 25px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #1f2937;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-bottom: 3px solid #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding-bottom: 15px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.form-group {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 20px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.form-label {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: block;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #374151;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.form-input,</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.form-select {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 100%;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.9375em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-family: 'Microsoft JhengHei', 'Microsoft YaHei', Arial, sans-serif;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.form-input:focus,</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.form-select:focus {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">outline: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 0 0 3px rgba(102,126,234,0.1);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.weekday-grid {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: grid;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">grid-template-columns: repeat(5, 1fr);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #f3f4f6;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.weekday-item {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.weekday-checkbox {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: none;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.weekday-label {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: block;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 12px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.weekday-checkbox:checked + .weekday-label {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #667eea;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.period-grid {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: grid;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">grid-template-columns: repeat(3, 1fr);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #f3f4f6;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.period-item {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.period-checkbox {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: none;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.period-label {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: block;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.875em;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.period-checkbox:checked + .period-label {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-color: #667eea;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.checkbox-group {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">align-items: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 10px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.checkbox-input {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">width: 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">height: 20px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-buttons {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-top: 25px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: flex-end;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 12px 30px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-btn:disabled {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #d1d5db;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: not-allowed;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: none;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-btn.primary {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-btn.primary:hover:not(:disabled) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #5568d3;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-btn.secondary {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #e5e7eb;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #374151;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-btn.secondary:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #d1d5db;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-btn.danger {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #ef4444;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.modal-btn.danger:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #dc2626;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.query-time-controls {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: flex;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">flex-wrap: wrap;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">justify-content: center;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin: 20px 0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.time-jump-btn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #667eea;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: none;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 12px 25px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cursor: pointer;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transition: all 0.3s;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.time-jump-btn:hover {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #5568d3;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: scale(1.05);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.toast {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">position: fixed;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">bottom: 30px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">right: 30px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #1f2937;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: white;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 15px 25px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 10px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">box-shadow: 0 5px 20px rgba(0,0,0,0.3);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">z-index: 2000;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">animation: slideIn 0.3s ease;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 0.9375em;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">@keyframes slideIn {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">from {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: translateX(400px);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">opacity: 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">to {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">transform: translateX(0);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">opacity: 1;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.individual-schedule-wrapper {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 20px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.teacher-select-grid {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">display: grid;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">gap: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin-bottom: 30px;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.confirmation-modal {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.confirmation-text {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-size: 1.125em;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #374151;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin: 20px 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">line-height: 1.6;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.warning-text {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #dc2626;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">.warning-box {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">background: #fef2f2;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border: 2px solid #ef4444;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">border-radius: 8px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">padding: 15px;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">margin: 15px 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: #991b1b;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">font-weight: bold;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">text-align: center;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/style&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;style&gt;@view-transition { navigation: auto; }&lt;/style&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;script src="</span><a href="https://cdn.tailwindcss.com" style="text-decoration:none"><span style="font-family:'Courier New'; text-decoration:underline; color:#0000ff">https://cdn.tailwindcss.com</span></a><span style="font-family:'Courier New'">" type="text/javascript"&gt;&lt;/script&gt;</span></p><p style="text-indent:6.3pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/head&gt;</span></p><p style="text-indent:6.3pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;body&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="app-container" id="appContainer"&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;header&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="header"&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="header-top"&gt;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;h1 class="header-title" id="systemTitle"&gt;💡 </span><span style="font-family:'Microsoft JhengHei'">輔導處智慧課表管理系統</span><span style="font-family:'Courier New'">&lt;/h1&gt;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="header-controls"&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stats-container"&gt;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-item"&gt;</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-icon"&gt;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">📊</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-content"&gt;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-number" id="weekScheduleCount"&gt;</span></p><p style="text-indent:69.3pt; font-size:10.5pt"><span style="font-family:'Courier New'">0</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-label"&gt;</span></p><p style="text-indent:69.3pt; font-size:10.5pt"><span style="font-family:'Microsoft JhengHei'">本週排程</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-item"&gt;</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-icon"&gt;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">🏫</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-content"&gt;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-number" id="classroomCount"&gt;</span></p><p style="text-indent:69.3pt; font-size:10.5pt"><span style="font-family:'Courier New'">0</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-label"&gt;</span></p><p style="text-indent:69.3pt; font-size:10.5pt"><span style="font-family:'Microsoft JhengHei'">教室節次</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-item"&gt;</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-icon"&gt;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">🏖️</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-content"&gt;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-number" id="leaveCount"&gt;</span></p><p style="text-indent:69.3pt; font-size:10.5pt"><span style="font-family:'Courier New'">0</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="stat-label"&gt;</span></p><p style="text-indent:69.3pt; font-size:10.5pt"><span style="font-family:'Microsoft JhengHei'">請假人次</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:56.7pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="font-size-controls"&gt;&lt;button class="font-btn" data-size="small"&gt;🅰️ </span><span style="font-family:'Microsoft JhengHei'">小</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="font-btn active" data-size="medium"&gt;A </span><span style="font-family:'Microsoft JhengHei'">中</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="font-btn" data-size="large"&gt;A+ </span><span style="font-family:'Microsoft JhengHei'">大</span><span style="font-family:'Courier New'">&lt;/button&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;&lt;button class="login-btn" id="loginBtn"&gt;🔒 </span><span style="font-family:'Microsoft JhengHei'">管理員登入</span><span style="font-family:'Courier New'">&lt;/button&gt;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/header&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;nav&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="nav-tabs"&gt;&lt;button class="nav-tab active" data-tab="complete"&gt;📊 </span><span style="font-family:'Microsoft JhengHei'">完整檢視</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="nav-tab" data-tab="simple"&gt;🔍 </span><span style="font-family:'Microsoft JhengHei'">精簡檢視</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="nav-tab" data-tab="individual"&gt;🧍 </span><span style="font-family:'Microsoft JhengHei'">人員課表</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="nav-tab" data-tab="support"&gt;🤝 </span><span style="font-family:'Microsoft JhengHei'">支援服務</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="nav-tab" data-tab="classroom"&gt;🏠 </span><span style="font-family:'Microsoft JhengHei'">教室使用</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="nav-tab admin-only" data-tab="settings" id="settingsTab"&gt;⚙️ </span><span style="font-family:'Microsoft JhengHei'">管理設定</span><span style="font-family:'Courier New'">&lt;/button&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/nav&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;main&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="date-navigation"&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="date-controls"&gt;&lt;button class="week-btn" id="prevWeekBtn"&gt;⬅️ </span><span style="font-family:'Microsoft JhengHei'">上週</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="week-btn" id="thisWeekBtn"&gt;📍 </span><span style="font-family:'Microsoft JhengHei'">本週</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="week-btn" id="nextWeekBtn"&gt;➡️ </span><span style="font-family:'Microsoft JhengHei'">下週</span><span style="font-family:'Courier New'">&lt;/button&gt;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="date-display" id="dateDisplay"&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Microsoft JhengHei'">載入中</span><span style="font-family:'Courier New'">...</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="admin-tools" id="adminTools" style="display: none;"&gt;&lt;button class="admin-btn" id="queryBtn"&gt;🔍 </span><span style="font-family:'Microsoft JhengHei'">查詢</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="admin-btn" id="quickCopyBtn"&gt;🔄 </span><span style="font-family:'Microsoft JhengHei'">快速複製</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="admin-btn danger" id="clearBtn"&gt;🗑️ </span><span style="font-family:'Microsoft JhengHei'">清空重置</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="admin-btn primary" id="newScheduleBtn"&gt;📝 </span><span style="font-family:'Microsoft JhengHei'">新排程</span><span style="font-family:'Courier New'">&lt;/button&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div id="scheduleContainer"&gt;&lt;/div&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/main&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal" id="loginModal"&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-content"&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-header"&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">🔐 </span><span style="font-family:'Microsoft JhengHei'">管理員登入</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;form id="loginForm"&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="form-group"&gt;&lt;label class="form-label" for="loginPassword"&gt;</span><span style="font-family:'Microsoft JhengHei'">密碼</span><span style="font-family:'Courier New'">&lt;/label&gt; &lt;input type="password" class="form-input" id="loginPassword" placeholder="</span><span style="font-family:'Microsoft JhengHei'">請輸入管理員密碼</span><span style="font-family:'Courier New'">" required&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-buttons"&gt;&lt;button type="button" class="modal-btn secondary" id="cancelLoginBtn"&gt;</span><span style="font-family:'Microsoft JhengHei'">取消</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button type="submit" class="modal-btn primary"&gt;</span><span style="font-family:'Microsoft JhengHei'">登入</span><span style="font-family:'Courier New'">&lt;/button&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/form&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal" id="scheduleModal"&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-content"&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-header" id="scheduleModalTitle"&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">📝 </span><span style="font-family:'Microsoft JhengHei'">新增排程</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div id="classroomWarning" class="warning-box" style="display: none;"&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">⚠️ </span><span style="font-family:'Microsoft JhengHei'">該教室在此時段已被預約</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;form id="scheduleForm"&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="form-group"&gt;&lt;label class="form-label"&gt;📅 </span><span style="font-family:'Microsoft JhengHei'">星期</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="weekday-grid"&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="weekday-item"&gt;&lt;input type="checkbox" class="weekday-checkbox" id="day1" value="</span><span style="font-family:'Microsoft JhengHei'">週一</span><span style="font-family:'Courier New'">"&gt; &lt;label for="day1" class="weekday-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">週一</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="weekday-item"&gt;&lt;input type="checkbox" class="weekday-checkbox" id="day2" value="</span><span style="font-family:'Microsoft JhengHei'">週二</span><span style="font-family:'Courier New'">"&gt; &lt;label for="day2" class="weekday-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">週二</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="weekday-item"&gt;&lt;input type="checkbox" class="weekday-checkbox" id="day3" value="</span><span style="font-family:'Microsoft JhengHei'">週三</span><span style="font-family:'Courier New'">"&gt; &lt;label for="day3" class="weekday-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">週三</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="weekday-item"&gt;&lt;input type="checkbox" class="weekday-checkbox" id="day4" value="</span><span style="font-family:'Microsoft JhengHei'">週四</span><span style="font-family:'Courier New'">"&gt; &lt;label for="day4" class="weekday-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">週四</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="weekday-item"&gt;&lt;input type="checkbox" class="weekday-checkbox" id="day5" value="</span><span style="font-family:'Microsoft JhengHei'">週五</span><span style="font-family:'Courier New'">"&gt; &lt;label for="day5" class="weekday-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">週五</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="form-group"&gt;&lt;label class="form-label"&gt;⏰ </span><span style="font-family:'Microsoft JhengHei'">時段</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="period-grid"&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="period-item"&gt;&lt;input type="checkbox" class="period-checkbox" id="period0" value="</span><span style="font-family:'Microsoft JhengHei'">早自修</span><span style="font-family:'Courier New'">"&gt; &lt;label for="period0" class="period-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">早自修</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="period-item"&gt;&lt;input type="checkbox" class="period-checkbox" id="period1" value="</span><span style="font-family:'Microsoft JhengHei'">第一節</span><span style="font-family:'Courier New'">"&gt; &lt;label for="period1" class="period-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">第一節</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="period-item"&gt;&lt;input type="checkbox" class="period-checkbox" id="period2" value="</span><span style="font-family:'Microsoft JhengHei'">第二節</span><span style="font-family:'Courier New'">"&gt; &lt;label for="period2" class="period-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">第二節</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="period-item"&gt;&lt;input type="checkbox" class="period-checkbox" id="period3" value="</span><span style="font-family:'Microsoft JhengHei'">第三節</span><span style="font-family:'Courier New'">"&gt; &lt;label for="period3" class="period-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">第三節</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="period-item"&gt;&lt;input type="checkbox" class="period-checkbox" id="period4" value="</span><span style="font-family:'Microsoft JhengHei'">第四節</span><span style="font-family:'Courier New'">"&gt; &lt;label for="period4" class="period-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">第四節</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="period-item"&gt;&lt;input type="checkbox" class="period-checkbox" id="period5" value="</span><span style="font-family:'Microsoft JhengHei'">午休</span><span style="font-family:'Courier New'">"&gt; &lt;label for="period5" class="period-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">午休</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="period-item"&gt;&lt;input type="checkbox" class="period-checkbox" id="period6" value="</span><span style="font-family:'Microsoft JhengHei'">第五節</span><span style="font-family:'Courier New'">"&gt; &lt;label for="period6" class="period-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">第五節</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="period-item"&gt;&lt;input type="checkbox" class="period-checkbox" id="period7" value="</span><span style="font-family:'Microsoft JhengHei'">第六節</span><span style="font-family:'Courier New'">"&gt; &lt;label for="period7" class="period-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">第六節</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="period-item"&gt;&lt;input type="checkbox" class="period-checkbox" id="period8" value="</span><span style="font-family:'Microsoft JhengHei'">第七節</span><span style="font-family:'Courier New'">"&gt; &lt;label for="period8" class="period-label"&gt;</span><span style="font-family:'Microsoft JhengHei'">第七節</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:44.1pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="form-group"&gt;&lt;label class="form-label" for="teacherSelect"&gt;👤 </span><span style="font-family:'Microsoft JhengHei'">負責人員</span><span style="font-family:'Courier New'">&lt;/label&gt; &lt;select class="form-select" id="teacherSelect" required&gt; &lt;option value=""&gt;</span><span style="font-family:'Microsoft JhengHei'">請選擇人員</span><span style="font-family:'Courier New'">...&lt;/option&gt; &lt;/select&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="form-group"&gt;&lt;label class="form-label" for="activityTypeSelect"&gt;📚 </span><span style="font-family:'Microsoft JhengHei'">活動類型</span><span style="font-family:'Courier New'">&lt;/label&gt; &lt;select class="form-select" id="activityTypeSelect" required&gt; &lt;option value=""&gt;</span><span style="font-family:'Microsoft JhengHei'">請選擇活動類型</span><span style="font-family:'Courier New'">...&lt;/option&gt; &lt;/select&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="form-group"&gt;&lt;label class="form-label" for="classroomSelect"&gt;🏫 </span><span style="font-family:'Microsoft JhengHei'">使用教室</span><span style="font-family:'Courier New'">&lt;/label&gt; &lt;select class="form-select" id="classroomSelect"&gt; &lt;option value="</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">"&gt;</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">&lt;/option&gt; &lt;/select&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="form-group"&gt;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="checkbox-group"&gt;&lt;input type="checkbox" class="checkbox-input" id="leaveCheckbox"&gt; &lt;label class="form-label" for="leaveCheckbox" style="margin: 0;"&gt;🏖️ </span><span style="font-family:'Microsoft JhengHei'">該節請假</span><span style="font-family:'Courier New'">&lt;/label&gt;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="form-group"&gt;&lt;label class="form-label" for="noteInput"&gt;📝 </span><span style="font-family:'Microsoft JhengHei'">備註</span><span style="font-family:'Courier New'">&lt;/label&gt; &lt;input type="text" class="form-input" id="noteInput" placeholder="</span><span style="font-family:'Microsoft JhengHei'">請輸入備註</span><span style="font-family:'Courier New'">"&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-buttons"&gt;&lt;button type="button" class="modal-btn secondary" id="cancelScheduleBtn"&gt;</span><span style="font-family:'Microsoft JhengHei'">取消</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button type="submit" class="modal-btn primary" id="saveScheduleBtn"&gt;💾 </span><span style="font-family:'Microsoft JhengHei'">儲存</span><span style="font-family:'Courier New'">&lt;/button&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/form&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal" id="queryModal"&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-content"&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-header"&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">🔍 </span><span style="font-family:'Microsoft JhengHei'">時間查詢</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="query-time-controls"&gt;&lt;button class="time-jump-btn" id="prevYearBtn"&gt;⏮️ </span><span style="font-family:'Microsoft JhengHei'">上一年</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="time-jump-btn" id="prevMonthBtn"&gt;⏪ </span><span style="font-family:'Microsoft JhengHei'">上個月</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="time-jump-btn" id="nextMonthBtn"&gt;⏩ </span><span style="font-family:'Microsoft JhengHei'">下個月</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button class="time-jump-btn" id="nextYearBtn"&gt;⏭️ </span><span style="font-family:'Microsoft JhengHei'">下一年</span><span style="font-family:'Courier New'">&lt;/button&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-buttons"&gt;&lt;button type="button" class="modal-btn secondary" id="cancelQueryBtn"&gt;</span><span style="font-family:'Microsoft JhengHei'">關閉</span><span style="font-family:'Courier New'">&lt;/button&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal" id="confirmModal"&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-content confirmation-modal"&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-header" id="confirmModalTitle"&gt;</span></p><p style="text-indent:31.5pt; font-size:10.5pt"><span style="font-family:'Courier New'">⚠️ </span><span style="font-family:'Microsoft JhengHei'">確認操作</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="confirmation-text" id="confirmModalText"&gt;&lt;/div&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;div class="modal-buttons"&gt;&lt;button type="button" class="modal-btn secondary" id="cancelConfirmBtn"&gt;</span><span style="font-family:'Microsoft JhengHei'">取消</span><span style="font-family:'Courier New'">&lt;/button&gt; &lt;button type="button" class="modal-btn danger" id="confirmActionBtn"&gt;</span><span style="font-family:'Microsoft JhengHei'">確認</span><span style="font-family:'Courier New'">&lt;/button&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:18.9pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/div&gt;</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;script&gt;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const DEFAULT_TEACHERS = [</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">專輔聖揚</span><span style="font-family:'Courier New'">', color: '#7accff', order: 1},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">專輔宜儒</span><span style="font-family:'Courier New'">', color: '#ff9ecf', order: 2},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">輔導組長</span><span style="font-family:'Courier New'">', color: '#d6bcfa', order: 3},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">親職組長</span><span style="font-family:'Courier New'">', color: '#ffd699', order: 4},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">特教組長</span><span style="font-family:'Courier New'">', color: '#ffe3e3', order: 5},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">輔導主任</span><span style="font-family:'Courier New'">', color: '#c7fae9', order: 6},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">學前巡迴</span><span style="font-family:'Courier New'">', color: '#cfe2fa', order: 7},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">心理師</span><span style="font-family:'Courier New'">', color: '#ff9999', order: 8},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">社工師</span><span style="font-family:'Courier New'">', color: '#99acff', order: 9},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">專業人員</span><span style="font-family:'Courier New'">', color: '#4ade80', order: 10},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">其他</span><span style="font-family:'Courier New'">', color: '#e6e6e6', order: 11},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">重要活動</span><span style="font-family:'Courier New'">', color: '#ff6b6b', order: 12},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#6b7280', order: 13},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#6b7280', order: 14},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#6b7280', order: 15},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#6b7280', order: 16},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#6b7280', order: 17}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">];</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const DEFAULT_ACTIVITIES = [</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">'</span><span style="font-family:'Microsoft JhengHei'">個別輔導</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">團體輔導</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">親師諮詢</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">學生諮詢</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">臨案協處</span><span style="font-family:'Courier New'">',</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">'</span><span style="font-family:'Microsoft JhengHei'">心理諮商</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">授課</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">代課</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">活動</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">研習</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">開會</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">放假</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">其他</span><span style="font-family:'Courier New'">',</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">'', '', '', '', '', '', ''</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">];</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const DEFAULT_CLASSROOMS = [</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">諮商室</span><span style="font-family:'Courier New'">', color: '#fbbf24', order: 1},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '</span><span style="font-family:'Microsoft JhengHei'">校史室</span><span style="font-family:'Courier New'">', color: '#34d399', order: 2},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#60a5fa', order: 3},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#f472b6', order: 4},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#a78bfa', order: 5},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#fb923c', order: 6},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#4ade80', order: 7},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#38bdf8', order: 8},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#fb7185', order: 9},</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">{name: '', color: '#c084fc', order: 10}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">];</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const DEFAULT_CONFIG = {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">system_title: '💡 </span><span style="font-family:'Microsoft JhengHei'">輔導處智慧課表管理系統</span><span style="font-family:'Courier New'">',</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">admin_password: 'ljps@418'</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">};</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekdays = ['</span><span style="font-family:'Microsoft JhengHei'">週一</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">週二</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">週三</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">週四</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">週五</span><span style="font-family:'Courier New'">'];</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const periods = ['</span><span style="font-family:'Microsoft JhengHei'">早自修</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">第一節</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">第二節</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">第三節</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">第四節</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">午休</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">第五節</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">第六節</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">第七節</span><span style="font-family:'Courier New'">'];</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let allData = [];</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let currentWeekOffset = 0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let isAdminMode = false;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let editingBatchId = null;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let editingWeekday = null;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let currentTab = 'complete';</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let hiddenTeachers = new Set();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let sidebarCollapsed = false;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let isSaving = false;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let isCopying = false;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let confirmCallback = null;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let cachedTeachers = null;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let cachedActivities = null;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let cachedClassrooms = null;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let cachedSystemTitle = null;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let cachedAdminPassword = null;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function renderEmptySchedule() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const container = document.getElementById('scheduleContainer');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let html = '&lt;div class="schedule-layout"&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teachers = getTeachers();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += renderSidebar(teachers);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="schedule-main"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;table class="schedule-table"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;thead&gt;&lt;tr&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;th class="period-header"&gt;</span><span style="font-family:'Microsoft JhengHei'">時段</span><span style="font-family:'Courier New'">&lt;/th&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th&gt;${day}&lt;/th&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;&lt;/thead&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tbody&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let period of periods) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tr&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th class="period-header"&gt;${period}&lt;/th&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let i = 0; i &lt; 5; i++) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;td&gt;&lt;/td&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tbody&gt;&lt;/table&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">container.innerHTML = html;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function loadConfigFromDatabase() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teachersData = allData.find(d =&gt; d.data_type === 'teachers_config');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activitiesData = allData.find(d =&gt; d.data_type === 'activities_config');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroomsData = allData.find(d =&gt; d.data_type === 'classrooms_config');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const systemTitleData = allData.find(d =&gt; d.data_type === 'system_title');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const adminPasswordData = allData.find(d =&gt; d.data_type === 'admin_password');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (teachersData &amp;&amp; teachersData.config_json) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">try {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedTeachers = JSON.parse(teachersData.config_json);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">} catch (e) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedTeachers = JSON.parse(JSON.stringify(DEFAULT_TEACHERS));</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedTeachers = JSON.parse(JSON.stringify(DEFAULT_TEACHERS));</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activitiesData &amp;&amp; activitiesData.config_json) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">try {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedActivities = JSON.parse(activitiesData.config_json);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">} catch (e) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedActivities = JSON.parse(JSON.stringify(DEFAULT_ACTIVITIES));</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedActivities = JSON.parse(JSON.stringify(DEFAULT_ACTIVITIES));</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (classroomsData &amp;&amp; classroomsData.config_json) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">try {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedClassrooms = JSON.parse(classroomsData.config_json);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">} catch (e) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedClassrooms = JSON.parse(JSON.stringify(DEFAULT_CLASSROOMS));</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedClassrooms = JSON.parse(JSON.stringify(DEFAULT_CLASSROOMS));</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedSystemTitle = systemTitleData ? systemTitleData.config_json : DEFAULT_CONFIG.system_title;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">cachedAdminPassword = adminPasswordData ? adminPasswordData.config_json : DEFAULT_CONFIG.admin_password;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function getTeachers() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return cachedTeachers || JSON.parse(JSON.stringify(DEFAULT_TEACHERS));</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function getActivities() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return cachedActivities || JSON.parse(JSON.stringify(DEFAULT_ACTIVITIES));</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function getClassrooms() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return cachedClassrooms || JSON.parse(JSON.stringify(DEFAULT_CLASSROOMS));</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function getSystemTitle() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return cachedSystemTitle || DEFAULT_CONFIG.system_title;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function getAdminPassword() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return cachedAdminPassword || DEFAULT_CONFIG.admin_password;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function getTeacherColor(teacherName) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teachers = getTeachers();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacher = teachers.find(t =&gt; t.name === teacherName);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return teacher ? teacher.color : '#6b7280';</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function getClassroomColor(classroomName) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classrooms = getClassrooms();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroom = classrooms.find(c =&gt; c.name === classroomName);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return classroom ? classroom.color : '#94a3b8';</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const dataHandler = {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">onDataChanged(data) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">allData = data;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">loadConfigFromDatabase();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateSystemTitle();</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">populateModalSelects();</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateStats();</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateQuickCopyButton();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">};</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function updateSystemTitle() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('systemTitle').textContent = getSystemTitle();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function getWeekDates(offset) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const now = new Date();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const currentDay = now.getDay();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const diff = currentDay === 0 ? -6 : 1 - currentDay;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const monday = new Date(now);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">monday.setDate(now.getDate() + diff + (offset * 7));</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">monday.setHours(0, 0, 0, 0);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const friday = new Date(monday);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">friday.setDate(monday.getDate() + 4);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">start: monday,</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">end: friday,</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">startStr: monday.toISOString().split('T')[0],</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">endStr: friday.toISOString().split('T')[0]</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">};</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function formatDateRange(dates) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const start = dates.start;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const end = dates.end;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return `${start.getFullYear()}</span><span style="font-family:'Microsoft JhengHei'">年</span><span style="font-family:'Courier New'">${start.getMonth() + 1}</span><span style="font-family:'Microsoft JhengHei'">月</span><span style="font-family:'Courier New'">${start.getDate()}</span><span style="font-family:'Microsoft JhengHei'">日</span><span style="font-family:'Courier New'"> - ${end.getFullYear()}</span><span style="font-family:'Microsoft JhengHei'">年</span><span style="font-family:'Courier New'">${end.getMonth() + 1}</span><span style="font-family:'Microsoft JhengHei'">月</span><span style="font-family:'Courier New'">${end.getDate()}</span><span style="font-family:'Microsoft JhengHei'">日</span><span style="font-family:'Courier New'">`;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function updateDateDisplay() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const dates = getWeekDates(currentWeekOffset);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('dateDisplay').textContent = formatDateRange(dates);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function getCurrentWeekSchedules() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const dates = getWeekDates(currentWeekOffset);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return allData.filter(s =&gt; s.data_type === 'schedule' &amp;&amp; s.week_start === dates.startStr);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function updateStats() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekSchedules = getCurrentWeekSchedules();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const batchGroups = new Map();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">weekSchedules.forEach(s =&gt; {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const batchKey = s.batch_id.split('_').slice(0, -1).join('_');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!batchGroups.has(batchKey)) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">batchGroups.set(batchKey, new Set());</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">batchGroups.get(batchKey).add(s.weekday);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let totalBatches = 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">batchGroups.forEach(weekdays =&gt; {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">totalBatches += weekdays.size;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('weekScheduleCount').textContent = totalBatches;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroomSessions = weekSchedules.filter(s =&gt; s.classroom &amp;&amp; s.classroom.trim() !== '' &amp;&amp; s.classroom !== '</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">').length;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('classroomCount').textContent = classroomSessions;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const leavesByWeekday = {};</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">weekSchedules.forEach(s =&gt; {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (s.is_leave) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const key = `${s.weekday}_${s.teacher}`;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">leavesByWeekday[key] = true;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('leaveCount').textContent = Object.keys(leavesByWeekday).length;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function updateQuickCopyButton() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekSchedules = getCurrentWeekSchedules();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const quickCopyBtn = document.getElementById('quickCopyBtn');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (weekSchedules.length &gt; 0) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">quickCopyBtn.disabled = true;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">quickCopyBtn.disabled = false;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function populateModalSelects() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teachers = getTeachers();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activities = getActivities();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classrooms = getClassrooms();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherSelect = document.getElementById('teacherSelect');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activitySelect = document.getElementById('activityTypeSelect');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroomSelect = document.getElementById('classroomSelect');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (teacherSelect) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">teacherSelect.innerHTML = '&lt;option value=""&gt;</span><span style="font-family:'Microsoft JhengHei'">請選擇人員</span><span style="font-family:'Courier New'">...&lt;/option&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">teachers.forEach(t =&gt; {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (t.name &amp;&amp; t.name.trim() !== '') {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const option = document.createElement('option');</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">option.value = t.name;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">option.textContent = t.name;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">teacherSelect.appendChild(option);</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activitySelect) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">activitySelect.innerHTML = '&lt;option value=""&gt;</span><span style="font-family:'Microsoft JhengHei'">請選擇活動類型</span><span style="font-family:'Courier New'">...&lt;/option&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">activities.forEach(activity =&gt; {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activity &amp;&amp; activity.trim() !== '') {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const option = document.createElement('option');</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">option.value = activity;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">option.textContent = activity;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">activitySelect.appendChild(option);</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (classroomSelect) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroomSelect.innerHTML = '&lt;option value="</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">"&gt;</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">&lt;/option&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">classrooms.forEach(c =&gt; {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (c.name &amp;&amp; c.name.trim() !== '') {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const option = document.createElement('option');</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">option.value = c.name;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">option.textContent = c.name;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroomSelect.appendChild(option);</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function setupModalEventListeners() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherSelect = document.getElementById('teacherSelect');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activitySelect = document.getElementById('activityTypeSelect');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroomSelect = document.getElementById('classroomSelect');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (teacherSelect) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">teacherSelect.removeEventListener('change', handleTeacherChange);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">teacherSelect.addEventListener('change', handleTeacherChange);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activitySelect) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">activitySelect.removeEventListener('change', handleActivityChange);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">activitySelect.addEventListener('change', handleActivityChange);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (classroomSelect) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroomSelect.removeEventListener('change', checkClassroomConflict);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroomSelect.addEventListener('change', checkClassroomConflict);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.querySelectorAll('.weekday-checkbox, .period-checkbox').forEach(cb =&gt; {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">cb.removeEventListener('change', checkClassroomConflict);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">cb.addEventListener('change', checkClassroomConflict);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function checkClassroomConflict() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroom = document.getElementById('classroomSelect').value;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const selectedDays = Array.from(document.querySelectorAll('.weekday-checkbox:checked')).map(cb =&gt; cb.value);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const selectedPeriods = Array.from(document.querySelectorAll('.period-checkbox:checked')).map(cb =&gt; cb.value);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const warningBox = document.getElementById('classroomWarning');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!classroom || classroom === '</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">' || selectedDays.length === 0 || selectedPeriods.length === 0) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">warningBox.style.display = 'none';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekSchedules = getCurrentWeekSchedules();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let hasConflict = false;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of selectedDays) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let period of selectedPeriods) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const existingInClassroom = weekSchedules.filter(s =&gt;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">s.weekday === day &amp;&amp;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">s.period === period &amp;&amp;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">s.classroom === classroom &amp;&amp;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">!(editingBatchId &amp;&amp; s.batch_id === editingBatchId &amp;&amp; s.weekday === editingWeekday)</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (existingInClassroom.length &gt; 0) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">hasConflict = true;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">break;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (hasConflict) break;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">warningBox.style.display = hasConflict ? 'block' : 'none';</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function handleTeacherChange() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacher = document.getElementById('teacherSelect').value;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activitySelect = document.getElementById('activityTypeSelect');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroomSelect = document.getElementById('classroomSelect');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (teacher === '</span><span style="font-family:'Microsoft JhengHei'">專輔聖揚</span><span style="font-family:'Courier New'">' || teacher === '</span><span style="font-family:'Microsoft JhengHei'">專輔宜儒</span><span style="font-family:'Courier New'">') {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">activitySelect.value = '</span><span style="font-family:'Microsoft JhengHei'">個別輔導</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroomSelect.value = '</span><span style="font-family:'Microsoft JhengHei'">諮商室</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else if (teacher === '</span><span style="font-family:'Microsoft JhengHei'">心理師</span><span style="font-family:'Courier New'">') {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">activitySelect.value = '</span><span style="font-family:'Microsoft JhengHei'">心理諮商</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroomSelect.value = '</span><span style="font-family:'Microsoft JhengHei'">諮商室</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">activitySelect.value = '</span><span style="font-family:'Microsoft JhengHei'">授課</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroomSelect.value = '</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">checkClassroomConflict();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function handleActivityChange() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activity = document.getElementById('activityTypeSelect').value;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroomSelect = document.getElementById('classroomSelect');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const counselingTypes = ['</span><span style="font-family:'Microsoft JhengHei'">個別輔導</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">團體輔導</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">親師諮詢</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">學生諮詢</span><span style="font-family:'Courier New'">', '</span><span style="font-family:'Microsoft JhengHei'">心理諮商</span><span style="font-family:'Courier New'">'];</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (counselingTypes.includes(activity)) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroomSelect.value = '</span><span style="font-family:'Microsoft JhengHei'">諮商室</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">checkClassroomConflict();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function renderSchedule() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const container = document.getElementById('scheduleContainer');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (currentTab === 'settings') {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSettingsView(container);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (currentTab === 'individual') {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderIndividualView(container);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (currentTab === 'support') {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSupportView(container);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (currentTab === 'classroom') {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderClassroomView(container);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (currentTab === 'simple') {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSimpleView(container);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderCompleteView(container);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function renderCompleteView(container) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekSchedules = getCurrentWeekSchedules();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teachers = getTeachers();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let html = '&lt;div class="schedule-layout"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += renderSidebar(teachers);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="schedule-main"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;table class="schedule-table"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;thead&gt;&lt;tr&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;th class="period-header"&gt;</span><span style="font-family:'Microsoft JhengHei'">時段</span><span style="font-family:'Courier New'">&lt;/th&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th&gt;${day}&lt;/th&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;&lt;/thead&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tbody&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let period of periods) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tr&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th class="period-header"&gt;${period}&lt;/th&gt;`;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;td&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activities = weekSchedules.filter(s =&gt;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">s.weekday === day &amp;&amp; s.period === period &amp;&amp; !hiddenTeachers.has(s.teacher)</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const sortedActivities = activities.sort((a, b) =&gt; {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherA = teachers.find(t =&gt; t.name === a.teacher);</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherB = teachers.find(t =&gt; t.name === b.teacher);</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const orderA = teacherA ? teacherA.order : 999;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const orderB = teacherB ? teacherB.order : 999;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">return orderA - orderB;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroomConflicts = new Map();</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">sortedActivities.forEach(activity =&gt; {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activity.classroom &amp;&amp; activity.classroom !== '</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">') {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const key = activity.classroom;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!classroomConflicts.has(key)) {</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroomConflicts.set(key, []);</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroomConflicts.get(key).push(activity);</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (sortedActivities.length &gt; 0) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="schedule-badges-container"&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let activity of sortedActivities) {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherColor = getTeacherColor(activity.teacher);</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const leaveIcon = activity.is_leave ? ' 🏖️' : '';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let activityClass = '';</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activity.activity_type === '</span><span style="font-family:'Microsoft JhengHei'">研習</span><span style="font-family:'Courier New'">') activityClass = ' training';</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activity.activity_type === '</span><span style="font-family:'Microsoft JhengHei'">放假</span><span style="font-family:'Courier New'">') activityClass = ' holiday';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">let conflictClass = '';</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activity.classroom &amp;&amp; activity.classroom !== '</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">') {</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const conflicts = classroomConflicts.get(activity.classroom);</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (conflicts &amp;&amp; conflicts.length &gt; 1) {</span></p><p style="text-indent:113.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">conflictClass = ' conflict';</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="schedule-badge${conflictClass}" style="background: ${teacherColor};"&gt;`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="badge-teacher"&gt;${activity.teacher}${leaveIcon}&lt;/div&gt;`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="badge-activity${activityClass}"&gt;${activity.activity_type}&lt;/div&gt;`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activity.classroom &amp;&amp; activity.classroom !== '</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">') {</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="badge-classroom"&gt;🏫 ${activity.classroom}&lt;/div&gt;`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activity.note &amp;&amp; activity.note.trim()) {</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="badge-note"&gt;📝 ${activity.note}&lt;/div&gt;`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (isAdminMode) {</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="activity-buttons"&gt;';</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;button class="edit-btn" onclick="editSchedule('${activity.batch_id}', '${day}')"&gt;</span><span style="font-family:'Microsoft JhengHei'">編輯</span><span style="font-family:'Courier New'">&lt;/button&gt;`;</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;button class="delete-btn" onclick="confirmDelete('${activity.batch_id}', '${day}')"&gt;</span><span style="font-family:'Microsoft JhengHei'">刪除</span><span style="font-family:'Courier New'">&lt;/button&gt;`;</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/td&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tbody&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/table&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">container.innerHTML = html;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function renderSimpleView(container) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekSchedules = getCurrentWeekSchedules();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teachers = getTeachers();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let html = '&lt;div class="schedule-layout"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += renderSidebar(teachers);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="schedule-main"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;table class="schedule-table"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;thead&gt;&lt;tr&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;th class="period-header"&gt;</span><span style="font-family:'Microsoft JhengHei'">時段</span><span style="font-family:'Courier New'">&lt;/th&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th&gt;${day}&lt;/th&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;&lt;/thead&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tbody&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let period of periods) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tr&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th class="period-header"&gt;${period}&lt;/th&gt;`;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;td&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activities = weekSchedules.filter(s =&gt;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">s.weekday === day &amp;&amp; s.period === period &amp;&amp; !hiddenTeachers.has(s.teacher)</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const sortedActivities = activities.sort((a, b) =&gt; {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherA = teachers.find(t =&gt; t.name === a.teacher);</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherB = teachers.find(t =&gt; t.name === b.teacher);</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const orderA = teacherA ? teacherA.order : 999;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const orderB = teacherB ? teacherB.order : 999;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">return orderA - orderB;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (sortedActivities.length &gt; 0) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="schedule-badges-container"&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let activity of sortedActivities) {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherColor = getTeacherColor(activity.teacher);</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const leaveIcon = activity.is_leave ? ' 🏖️' : '';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="simple-badge" style="background: ${teacherColor};"&gt;`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `${activity.teacher}${leaveIcon}`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/td&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tbody&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/table&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">container.innerHTML = html;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function renderSupportView(container) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekSchedules = getCurrentWeekSchedules();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teachers = getTeachers();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let html = '&lt;div class="schedule-main" style="margin: 0 auto;"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;table class="schedule-table"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;thead&gt;&lt;tr&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;th class="period-header"&gt;</span><span style="font-family:'Microsoft JhengHei'">時段</span><span style="font-family:'Courier New'">&lt;/th&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th&gt;${day}&lt;/th&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;&lt;/thead&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tbody&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let period of periods) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tr&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th class="period-header"&gt;${period}&lt;/th&gt;`;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;td&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activities = weekSchedules.filter(s =&gt;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">s.weekday === day &amp;&amp; s.period === period</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const busyTeachers = new Set(activities.map(a =&gt; a.teacher));</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const priority1Name = teachers[0] ? teachers[0].name : null;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const priority2Name = teachers[1] ? teachers[1].name : null;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">let supportPerson = null;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (priority1Name &amp;&amp; priority2Name) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (busyTeachers.has(priority1Name) &amp;&amp; !busyTeachers.has(priority2Name)) {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">supportPerson = priority2Name;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else if (!busyTeachers.has(priority1Name) &amp;&amp; busyTeachers.has(priority2Name)) {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">supportPerson = priority1Name;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else if (busyTeachers.has(priority1Name) &amp;&amp; busyTeachers.has(priority2Name)) {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let i = 2; i &lt; 4 &amp;&amp; i &lt; teachers.length; i++) {</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherName = teachers[i].name;</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (teacherName &amp;&amp; !busyTeachers.has(teacherName)) {</span></p><p style="text-indent:113.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">supportPerson = teacherName;</span></p><p style="text-indent:113.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">break;</span></p><p style="text-indent:100.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (supportPerson) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const supportColor = getTeacherColor(supportPerson);</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="support-badge" style="background: ${supportColor}; color: #000;"&gt;`;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += supportPerson;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="all-support"&gt;</span><span style="font-family:'Microsoft JhengHei'">皆可支援</span><span style="font-family:'Courier New'">&lt;/div&gt;';</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/td&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tbody&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/table&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">container.innerHTML = html;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function renderClassroomView(container) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekSchedules = getCurrentWeekSchedules();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classrooms = getClassrooms();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let html = '&lt;div class="schedule-main" style="margin: 0 auto;"&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let c of classrooms) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!c.name || c.name.trim() === '') continue;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroomName = c.name;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroomColor = c.color;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;h3 style="margin: 20px 0 10px 20px; color: ${classroomColor}; font-weight: bold;"&gt;🏫 ${classroomName}&lt;/h3&gt;`;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;table class="schedule-table" style="margin-bottom: 30px;"&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;thead&gt;&lt;tr&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;th class="period-header"&gt;</span><span style="font-family:'Microsoft JhengHei'">時段</span><span style="font-family:'Courier New'">&lt;/th&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th&gt;${day}&lt;/th&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;&lt;/thead&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tbody&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let period of periods) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tr&gt;';</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th class="period-header"&gt;${period}&lt;/th&gt;`;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;td&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activities = weekSchedules.filter(s =&gt;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">s.weekday === day &amp;&amp; s.period === period &amp;&amp; s.classroom === classroomName</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let activity of activities) {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="classroom-badge" style="background: ${classroomColor};"&gt;`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="classroom-name"&gt;${classroomName}&lt;/div&gt;`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="classroom-teacher"&gt;${activity.teacher}&lt;/div&gt;`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="classroom-activity"&gt;${activity.activity_type}&lt;/div&gt;`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/td&gt;';</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tbody&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/table&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">container.innerHTML = html;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function renderSidebar(teachers) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let html = `&lt;div class="teacher-sidebar ${sidebarCollapsed ? 'collapsed' : ''}"&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="sidebar-header"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!sidebarCollapsed) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="sidebar-title"&gt;👥 </span><span style="font-family:'Microsoft JhengHei'">人員控制</span><span style="font-family:'Courier New'">&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;button class="collapse-btn" onclick="toggleSidebar()"&gt;${sidebarCollapsed ? '▶️' : '◀️'}&lt;/button&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="teacher-list"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let t of teachers) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!t.name || t.name.trim() === '') continue;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherName = t.name;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const color = t.color;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const isHidden = hiddenTeachers.has(teacherName);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const toggleClass = isHidden ? 'teacher-toggle-btn hidden-state' : 'teacher-toggle-btn';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const toggleText = sidebarCollapsed ? (isHidden ? '👻' : '✔️') : (isHidden ? '👻 </span><span style="font-family:'Microsoft JhengHei'">隱藏中</span><span style="font-family:'Courier New'">' : '✔️ </span><span style="font-family:'Microsoft JhengHei'">顯示中</span><span style="font-family:'Courier New'">');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="teacher-item"&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="teacher-color" style="background: ${color};"&gt;&lt;/div&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!sidebarCollapsed) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="teacher-name-text"&gt;${teacherName}&lt;/div&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;button class="${toggleClass}" onclick="toggleTeacher('${teacherName}')"&gt;${toggleText}&lt;/button&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">return html;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function renderIndividualView(container) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teachers = getTeachers();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let html = '&lt;div class="individual-schedule-wrapper"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;h2 style="margin-bottom: 20px; color: #1f2937; font-size: 1.5em;"&gt;👤 </span><span style="font-family:'Microsoft JhengHei'">選擇教師查看個人課表</span><span style="font-family:'Courier New'">&lt;/h2&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="teacher-select-grid"&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let t of teachers) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!t.name || t.name.trim() === '') continue;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherName = t.name;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const color = t.color;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;button class="admin-btn" onclick="selectTeacher('${teacherName}')" style="padding: 15px; font-size: 1em;"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;span style="display: inline-block; width: 12px; height: 12px; background: ${color}; border-radius: 3px; margin-right: 8px;"&gt;&lt;/span&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `${teacherName}`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;/button&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div id="individualScheduleContent"&gt;&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">container.innerHTML = html;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function renderSettingsView(container) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teachers = getTeachers();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activities = getActivities();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classrooms = getClassrooms();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const systemTitle = getSystemTitle();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const adminPassword = getAdminPassword();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let html = '&lt;div class="settings-container"&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="settings-section"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;h2 class="settings-section-title"&gt;🔧 </span><span style="font-family:'Microsoft JhengHei'">系統設定</span><span style="font-family:'Courier New'">&lt;/h2&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="settings-form-group"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;label class="settings-label" for="systemTitleInput"&gt;</span><span style="font-family:'Microsoft JhengHei'">系統標題</span><span style="font-family:'Courier New'">&lt;/label&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;input type="text" class="settings-input" id="systemTitleInput" value="${systemTitle}"&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="settings-form-group"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;label class="settings-label" for="adminPasswordInput"&gt;</span><span style="font-family:'Microsoft JhengHei'">管理員密碼</span><span style="font-family:'Courier New'">&lt;/label&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;input type="password" class="settings-input" id="adminPasswordInput" value="${adminPassword}"&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;button class="save-settings-btn" onclick="saveSystemSettings()"&gt;💾 </span><span style="font-family:'Microsoft JhengHei'">儲存系統設定</span><span style="font-family:'Courier New'">&lt;/button&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="settings-section"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;h2 class="settings-section-title"&gt;👥 </span><span style="font-family:'Microsoft JhengHei'">人員配置</span><span style="font-family:'Courier New'">（</span><span style="font-family:'Microsoft JhengHei'">含空白擴充欄位</span><span style="font-family:'Courier New'">）&lt;/h2&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="config-list"&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let i = 0; i &lt; teachers.length; i++) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const t = teachers[i];</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherName = t.name || '';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const color = t.color;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const isNewSlot = !teacherName || teacherName.trim() === '';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="config-item${isNewSlot ? ' new-slot' : ''}"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="color-preview" id="teacher_preview_${i}" style="background: ${color};"&gt;&lt;/div&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;input type="text" class="config-name-input" id="teacher_name_${i}" value="${teacherName}" placeholder="${isNewSlot ? '</span><span style="font-family:'Microsoft JhengHei'">新增人員</span><span style="font-family:'Courier New'">' : '</span><span style="font-family:'Microsoft JhengHei'">人員名稱</span><span style="font-family:'Courier New'">'}"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="color-picker-wrapper"&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;input type="color" class="color-picker" id="teacher_picker_${i}" value="${color}" onchange="updateColorPreview('teacher', ${i}, this.value)"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;input type="text" class="color-input" id="teacher_input_${i}" value="${color}" oninput="updateColorFromInput('teacher', ${i}, this.value)"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;button class="save-settings-btn" onclick="saveTeacherSettings()"&gt;💾 </span><span style="font-family:'Microsoft JhengHei'">儲存人員配置</span><span style="font-family:'Courier New'">&lt;/button&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="settings-section"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;h2 class="settings-section-title"&gt;📚 </span><span style="font-family:'Microsoft JhengHei'">活動類型配置</span><span style="font-family:'Courier New'">（</span><span style="font-family:'Microsoft JhengHei'">含空白擴充欄位</span><span style="font-family:'Courier New'">）&lt;/h2&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="activity-grid"&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let i = 0; i &lt; activities.length; i++) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activity = activities[i] || '';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const isNewSlot = !activity || activity.trim() === '';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="activity-item${isNewSlot ? ' new-slot' : ''}"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;input type="text" class="activity-input" id="activity_${i}" value="${activity}" placeholder="${isNewSlot ? '</span><span style="font-family:'Microsoft JhengHei'">新增活動類型</span><span style="font-family:'Courier New'">' : '</span><span style="font-family:'Microsoft JhengHei'">活動類型</span><span style="font-family:'Courier New'">'}"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;button class="save-settings-btn" onclick="saveActivitySettings()"&gt;💾 </span><span style="font-family:'Microsoft JhengHei'">儲存活動類型</span><span style="font-family:'Courier New'">&lt;/button&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="settings-section"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;h2 class="settings-section-title"&gt;🏫 </span><span style="font-family:'Microsoft JhengHei'">教室配置</span><span style="font-family:'Courier New'">（</span><span style="font-family:'Microsoft JhengHei'">含空白擴充欄位</span><span style="font-family:'Courier New'">）&lt;/h2&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="config-list"&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let i = 0; i &lt; classrooms.length; i++) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const c = classrooms[i];</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroomName = c.name || '';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const color = c.color;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const isNewSlot = !classroomName || classroomName.trim() === '';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="config-item${isNewSlot ? ' new-slot' : ''}"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="color-preview" id="classroom_preview_${i}" style="background: ${color};"&gt;&lt;/div&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;input type="text" class="config-name-input" id="classroom_name_${i}" value="${classroomName}" placeholder="${isNewSlot ? '</span><span style="font-family:'Microsoft JhengHei'">新增教室</span><span style="font-family:'Courier New'">' : '</span><span style="font-family:'Microsoft JhengHei'">教室名稱</span><span style="font-family:'Courier New'">'}"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="color-picker-wrapper"&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;input type="color" class="color-picker" id="classroom_picker_${i}" value="${color}" onchange="updateColorPreview('classroom', ${i}, this.value)"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;input type="text" class="color-input" id="classroom_input_${i}" value="${color}" oninput="updateColorFromInput('classroom', ${i}, this.value)"&gt;`;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;button class="save-settings-btn" onclick="saveClassroomSettings()"&gt;💾 </span><span style="font-family:'Microsoft JhengHei'">儲存教室配置</span><span style="font-family:'Courier New'">&lt;/button&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">container.innerHTML = html;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function selectTeacher(teacherName) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekSchedules = getCurrentWeekSchedules();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherSchedules = weekSchedules.filter(s =&gt; s.teacher === teacherName);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacherColor = getTeacherColor(teacherName);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">let html = `&lt;h3 style="margin: 30px 0 20px 0; color: ${teacherColor}; font-size: 1.5em; font-weight: bold;"&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;span style="display: inline-block; width: 20px; height: 20px; background: ${teacherColor}; border-radius: 5px; margin-right: 10px;"&gt;&lt;/span&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `${teacherName} </span><span style="font-family:'Microsoft JhengHei'">的課表</span><span style="font-family:'Courier New'">&lt;/h3&gt;`;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;div class="schedule-main"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;table class="schedule-table"&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;thead&gt;&lt;tr&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;th class="period-header"&gt;</span><span style="font-family:'Microsoft JhengHei'">時段</span><span style="font-family:'Courier New'">&lt;/th&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th&gt;${day}&lt;/th&gt;`;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;&lt;/thead&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tbody&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let period of periods) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;tr&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;th class="period-header"&gt;${period}&lt;/th&gt;`;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of weekdays) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;td&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activities = teacherSchedules.filter(s =&gt;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">s.weekday === day &amp;&amp; s.period === period</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let activity of activities) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const leaveIcon = activity.is_leave ? ' 🏖️' : '';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="schedule-badge" style="background: ${teacherColor};"&gt;`;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="badge-teacher"&gt;${activity.activity_type}${leaveIcon}&lt;/div&gt;`;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activity.classroom &amp;&amp; activity.classroom !== '</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">') {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="badge-classroom"&gt;🏫 ${activity.classroom}&lt;/div&gt;`;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activity.note) {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += `&lt;div class="badge-classroom"&gt;📝 ${activity.note}&lt;/div&gt;`;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/td&gt;';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tr&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/tbody&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/table&gt;';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">html += '&lt;/div&gt;';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('individualScheduleContent').innerHTML = html;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function toggleTeacher(teacherName) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (hiddenTeachers.has(teacherName)) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">hiddenTeachers.delete(teacherName);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">hiddenTeachers.add(teacherName);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function toggleSidebar() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">sidebarCollapsed = !sidebarCollapsed;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function updateColorPreview(type, index, color) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById(`${type}_preview_${index}`).style.background = color;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById(`${type}_input_${index}`).value = color;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function updateColorFromInput(type, index, color) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (/^#[0-9A-Fa-f]{6}$/.test(color)) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById(`${type}_preview_${index}`).style.background = color;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById(`${type}_picker_${index}`).value = color;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">async function saveSystemSettings() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const saveBtn = event.target;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (saveBtn) saveBtn.disabled = true;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const title = document.getElementById('systemTitleInput').value;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const password = document.getElementById('adminPasswordInput').value;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const existingTitleData = allData.find(d =&gt; d.data_type === 'system_title');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const existingPasswordData = allData.find(d =&gt; d.data_type === 'admin_password');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (existingTitleData) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">existingTitleData.config_json = title;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.update(existingTitleData);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.create({</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">id: `config_system_title_${Date.now()}`,</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">data_type: 'system_title',</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">config_json: title</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (existingPasswordData) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">existingPasswordData.config_json = password;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.update(existingPasswordData);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.create({</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">id: `config_admin_password_${Date.now()}`,</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">data_type: 'admin_password',</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">config_json: password</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (saveBtn) saveBtn.disabled = false;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('✅ </span><span style="font-family:'Microsoft JhengHei'">系統設定已儲存</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">async function saveTeacherSettings() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const saveBtn = event.target;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">saveBtn.disabled = true;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teachers = getTeachers();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const newTeachersArray = [];</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let i = 0; i &lt; teachers.length; i++) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const nameInput = document.getElementById(`teacher_name_${i}`);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const colorInput = document.getElementById(`teacher_input_${i}`);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (nameInput &amp;&amp; colorInput) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">newTeachersArray.push({</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">name: nameInput.value.trim(),</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: colorInput.value,</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">order: i + 1</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const configJson = JSON.stringify(newTeachersArray);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const existingConfig = allData.find(d =&gt; d.data_type === 'teachers_config');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (existingConfig) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">existingConfig.config_json = configJson;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.update(existingConfig);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.create({</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">id: `config_teachers_${Date.now()}`,</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">data_type: 'teachers_config',</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">config_json: configJson</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">saveBtn.disabled = false;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('✅ </span><span style="font-family:'Microsoft JhengHei'">人員配置已儲存</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">async function saveActivitySettings() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const saveBtn = event.target;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">saveBtn.disabled = true;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activities = getActivities();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const newActivitiesArray = [];</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let i = 0; i &lt; activities.length; i++) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activityInput = document.getElementById(`activity_${i}`);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (activityInput) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">newActivitiesArray.push(activityInput.value.trim());</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const configJson = JSON.stringify(newActivitiesArray);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const existingConfig = allData.find(d =&gt; d.data_type === 'activities_config');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (existingConfig) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">existingConfig.config_json = configJson;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.update(existingConfig);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.create({</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">id: `config_activities_${Date.now()}`,</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">data_type: 'activities_config',</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">config_json: configJson</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">saveBtn.disabled = false;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('✅ </span><span style="font-family:'Microsoft JhengHei'">活動類型已儲存</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">async function saveClassroomSettings() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const saveBtn = event.target;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">saveBtn.disabled = true;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classrooms = getClassrooms();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const newClassroomsArray = [];</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let i = 0; i &lt; classrooms.length; i++) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const nameInput = document.getElementById(`classroom_name_${i}`);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const colorInput = document.getElementById(`classroom_input_${i}`);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (nameInput &amp;&amp; colorInput) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">newClassroomsArray.push({</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">name: nameInput.value.trim(),</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">color: colorInput.value,</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">order: i + 1</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const configJson = JSON.stringify(newClassroomsArray);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const existingConfig = allData.find(d =&gt; d.data_type === 'classrooms_config');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (existingConfig) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">existingConfig.config_json = configJson;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.update(existingConfig);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.create({</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">id: `config_classrooms_${Date.now()}`,</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">data_type: 'classrooms_config',</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">config_json: configJson</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">saveBtn.disabled = false;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('✅ </span><span style="font-family:'Microsoft JhengHei'">教室配置已儲存</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">async function saveSchedule(event) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">event.preventDefault();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (isSaving) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('⏳ </span><span style="font-family:'Microsoft JhengHei'">正在儲存</span><span style="font-family:'Courier New'">，</span><span style="font-family:'Microsoft JhengHei'">請稍候</span><span style="font-family:'Courier New'">...');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">isSaving = true;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('saveScheduleBtn').disabled = true;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const selectedDays = Array.from(document.querySelectorAll('.weekday-checkbox:checked')).map(cb =&gt; cb.value);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const selectedPeriods = Array.from(document.querySelectorAll('.period-checkbox:checked')).map(cb =&gt; cb.value);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const teacher = document.getElementById('teacherSelect').value;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const activityType = document.getElementById('activityTypeSelect').value;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const classroom = document.getElementById('classroomSelect').value;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const isLeave = document.getElementById('leaveCheckbox').checked;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const note = document.getElementById('noteInput').value;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (selectedDays.length === 0 || selectedPeriods.length === 0) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('⚠️ </span><span style="font-family:'Microsoft JhengHei'">請選擇星期和時段</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">isSaving = false;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('saveScheduleBtn').disabled = false;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const dates = getWeekDates(currentWeekOffset);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (editingBatchId &amp;&amp; editingWeekday) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const toDelete = allData.filter(s =&gt; s.data_type === 'schedule' &amp;&amp; s.batch_id === editingBatchId &amp;&amp; s.weekday === editingWeekday);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let schedule of toDelete) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.delete(schedule);</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of selectedDays) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const batchId = day === editingWeekday ? editingBatchId : `batch_${Date.now()}_${Math.random().toString(36).substr(2, 9)}_${day}`;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let period of selectedPeriods) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const scheduleData = {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">id: `${batchId}_${period}`,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">data_type: 'schedule',</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">teacher: teacher,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">weekday: day,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">period: period,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">activity_type: activityType,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroom: classroom,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">is_leave: isLeave,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">note: note,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">week_start: dates.startStr,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">batch_id: batchId</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">};</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const result = await window.dataSdk.create(scheduleData);</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!result.isOk) {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('❌ </span><span style="font-family:'Microsoft JhengHei'">儲存失敗</span><span style="font-family:'Courier New'">，</span><span style="font-family:'Microsoft JhengHei'">請重試</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">isSaving = false;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('saveScheduleBtn').disabled = false;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let day of selectedDays) {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const batchId = `batch_${Date.now()}_${Math.random().toString(36).substr(2, 9)}_${day}`;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let period of selectedPeriods) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const scheduleData = {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">id: `${batchId}_${period}`,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">data_type: 'schedule',</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">teacher: teacher,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">weekday: day,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">period: period,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">activity_type: activityType,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroom: classroom,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">is_leave: isLeave,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">note: note,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">week_start: dates.startStr,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">batch_id: batchId</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">};</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const result = await window.dataSdk.create(scheduleData);</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!result.isOk) {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('❌ </span><span style="font-family:'Microsoft JhengHei'">儲存失敗</span><span style="font-family:'Courier New'">，</span><span style="font-family:'Microsoft JhengHei'">請重試</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">isSaving = false;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('saveScheduleBtn').disabled = false;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">closeScheduleModal();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast(editingBatchId ? '✅ </span><span style="font-family:'Microsoft JhengHei'">排程已更新</span><span style="font-family:'Courier New'">' : '✅ </span><span style="font-family:'Microsoft JhengHei'">排程已新增</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">editingBatchId = null;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">editingWeekday = null;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">isSaving = false;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('saveScheduleBtn').disabled = false;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function editSchedule(batchId, weekday) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">showConfirm(</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">'✏️ </span><span style="font-family:'Microsoft JhengHei'">確認編輯</span><span style="font-family:'Courier New'">',</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">`</span><span style="font-family:'Microsoft JhengHei'">確定要編輯</span><span style="font-family:'MS Gothic'">「</span><span style="font-family:'Courier New'">${weekday}</span><span style="font-family:'MS Gothic'">」</span><span style="font-family:'Microsoft JhengHei'">的這組排程嗎</span><span style="font-family:'Courier New'">？`,</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">() =&gt; {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const schedules = allData.filter(s =&gt; s.data_type === 'schedule' &amp;&amp; s.batch_id === batchId &amp;&amp; s.weekday === weekday);</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (schedules.length === 0) return;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const first = schedules[0];</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">editingBatchId = batchId;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">editingWeekday = weekday;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('scheduleModalTitle').textContent = '✏️ </span><span style="font-family:'Microsoft JhengHei'">編輯排程</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('teacherSelect').value = first.teacher;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('activityTypeSelect').value = first.activity_type;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('classroomSelect').value = first.classroom || '</span><span style="font-family:'Microsoft JhengHei'">不使用教室</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('leaveCheckbox').checked = first.is_leave;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('noteInput').value = first.note || '';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.querySelectorAll('.weekday-checkbox').forEach(cb =&gt; {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">cb.checked = cb.value === weekday;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.querySelectorAll('.period-checkbox').forEach(cb =&gt; {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">cb.checked = schedules.some(s =&gt; s.period === cb.value);</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">checkClassroomConflict();</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('scheduleModal').classList.add('active');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function confirmDelete(batchId, weekday) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">showConfirm(</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">'🗑️ </span><span style="font-family:'Microsoft JhengHei'">確認刪除</span><span style="font-family:'Courier New'">',</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">`&lt;span class="warning-text"&gt;</span><span style="font-family:'Microsoft JhengHei'">確定要刪除</span><span style="font-family:'MS Gothic'">「</span><span style="font-family:'Courier New'">${weekday}</span><span style="font-family:'MS Gothic'">」</span><span style="font-family:'Microsoft JhengHei'">的這組排程嗎</span><span style="font-family:'Courier New'">？</span><span style="font-family:'Microsoft JhengHei'">此操作無法復原</span><span style="font-family:'MS Gothic'">。</span><span style="font-family:'Courier New'">&lt;/span&gt;`,</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">async () =&gt; {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const schedules = allData.filter(s =&gt; s.data_type === 'schedule' &amp;&amp; s.batch_id === batchId &amp;&amp; s.weekday === weekday);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let schedule of schedules) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.delete(schedule);</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('✅ </span><span style="font-family:'Microsoft JhengHei'">排程已刪除</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">async function quickCopy() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (isCopying) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('⏳ </span><span style="font-family:'Microsoft JhengHei'">正在複製</span><span style="font-family:'Courier New'">，</span><span style="font-family:'Microsoft JhengHei'">請稍候</span><span style="font-family:'Courier New'">...');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekSchedules = getCurrentWeekSchedules();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (weekSchedules.length &gt; 0) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('⚠️ </span><span style="font-family:'Microsoft JhengHei'">本週已有資料</span><span style="font-family:'Courier New'">，</span><span style="font-family:'Microsoft JhengHei'">無法複製</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">showConfirm(</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">'🔄 </span><span style="font-family:'Microsoft JhengHei'">確認複製</span><span style="font-family:'Courier New'">',</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">'</span><span style="font-family:'Microsoft JhengHei'">確定要將上週的排程複製到本週嗎</span><span style="font-family:'Courier New'">？',</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">async () =&gt; {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">isCopying = true;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('quickCopyBtn').disabled = true;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const currentDates = getWeekDates(currentWeekOffset);</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const prevDates = getWeekDates(currentWeekOffset - 1);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const prevWeekSchedules = allData.filter(s =&gt; s.data_type === 'schedule' &amp;&amp; s.week_start === prevDates.startStr);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (prevWeekSchedules.length === 0) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('ℹ️ </span><span style="font-family:'Microsoft JhengHei'">上週無資料可複製</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">isCopying = false;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('quickCopyBtn').disabled = false;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const batchMapping = new Map();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let schedule of prevWeekSchedules) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const originalBatchBase = schedule.batch_id.split('_').slice(0, -1).join('_');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!batchMapping.has(originalBatchBase)) {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">const newBatchBase = `batch_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">batchMapping.set(originalBatchBase, newBatchBase);</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const newBatchBase = batchMapping.get(originalBatchBase);</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const newBatchId = `${newBatchBase}_${schedule.weekday}`;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">const newSchedule = {</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">id: `${newBatchId}_${schedule.period}`,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">data_type: 'schedule',</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">teacher: schedule.teacher,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">weekday: schedule.weekday,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">period: schedule.period,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">activity_type: schedule.activity_type,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">classroom: schedule.classroom,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">is_leave: schedule.is_leave,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">note: schedule.note,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">week_start: currentDates.startStr,</span></p><p style="text-indent:88.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">batch_id: newBatchId</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">};</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.create(newSchedule);</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('✅ </span><span style="font-family:'Microsoft JhengHei'">已複製上週資料</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">isCopying = false;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('quickCopyBtn').disabled = false;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">async function clearWeek() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">showConfirm(</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">'🗑️ </span><span style="font-family:'Microsoft JhengHei'">確認清空</span><span style="font-family:'Courier New'">',</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">'&lt;span class="warning-text"&gt;</span><span style="font-family:'Microsoft JhengHei'">確定要清空本週所有排程資料嗎</span><span style="font-family:'Courier New'">？</span><span style="font-family:'Microsoft JhengHei'">此操作無法復原</span><span style="font-family:'MS Gothic'">。</span><span style="font-family:'Courier New'">&lt;/span&gt;',</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">async () =&gt; {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const dates = getWeekDates(currentWeekOffset);</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">const weekSchedules = allData.filter(s =&gt; s.data_type === 'schedule' &amp;&amp; s.week_start === dates.startStr);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (weekSchedules.length === 0) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('ℹ️ </span><span style="font-family:'Microsoft JhengHei'">本週無資料</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">for (let schedule of weekSchedules) {</span></p><p style="text-indent:75.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">await window.dataSdk.delete(schedule);</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('✅ </span><span style="font-family:'Microsoft JhengHei'">本週資料已清空</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function openScheduleModal() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">editingBatchId = null;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">editingWeekday = null;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('scheduleModalTitle').textContent = '📝 </span><span style="font-family:'Microsoft JhengHei'">新增排程</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('scheduleForm').reset();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('classroomWarning').style.display = 'none';</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">populateModalSelects();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">setupModalEventListeners();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">handleTeacherChange();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('scheduleModal').classList.add('active');</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function closeScheduleModal() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('scheduleModal').classList.remove('active');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">editingBatchId = null;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">editingWeekday = null;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function openQueryModal() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('queryModal').classList.add('active');</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function closeQueryModal() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('queryModal').classList.remove('active');</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function showConfirm(title, message, callback) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('confirmModalTitle').textContent = title;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('confirmModalText').innerHTML = message;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">confirmCallback = callback;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('confirmModal').classList.add('active');</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function closeConfirmModal() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('confirmModal').classList.remove('active');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">confirmCallback = null;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function executeConfirm() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (confirmCallback) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">confirmCallback();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">closeConfirmModal();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">function showToast(message) {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const toast = document.createElement('div');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">toast.className = 'toast';</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">toast.textContent = message;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.body.appendChild(toast);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">setTimeout(() =&gt; {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">toast.remove();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}, 3000);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('prevWeekBtn').addEventListener('click', () =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">currentWeekOffset--;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateDateDisplay();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateStats();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateQuickCopyButton();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('thisWeekBtn').addEventListener('click', () =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">currentWeekOffset = 0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateDateDisplay();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateStats();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateQuickCopyButton();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('nextWeekBtn').addEventListener('click', () =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">currentWeekOffset++;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateDateDisplay();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateStats();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateQuickCopyButton();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginBtn').addEventListener('click', () =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (isAdminMode) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">isAdminMode = false;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginBtn').innerHTML = '🔒 </span><span style="font-family:'Microsoft JhengHei'">管理員登入</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginBtn').classList.remove('logged-in');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('adminTools').style.display = 'none';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('settingsTab').classList.remove('visible');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (currentTab === 'settings') {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">currentTab = 'complete';</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.querySelectorAll('.nav-tab').forEach(t =&gt; t.classList.remove('active'));</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.querySelector('[data-tab="complete"]').classList.add('active');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('✅ </span><span style="font-family:'Microsoft JhengHei'">已登出管理員模式</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginModal').classList.add('active');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginForm').addEventListener('submit', (e) =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">e.preventDefault();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const password = document.getElementById('loginPassword').value;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const correctPassword = getAdminPassword();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (password === correctPassword) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">isAdminMode = true;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginBtn').innerHTML = '✅ </span><span style="font-family:'Microsoft JhengHei'">管理員模式</span><span style="font-family:'Courier New'">';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginBtn').classList.add('logged-in');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('adminTools').style.display = 'flex';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('settingsTab').classList.add('visible');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginModal').classList.remove('active');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginPassword').value = '';</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('✅ </span><span style="font-family:'Microsoft JhengHei'">已進入管理員模式</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('❌ </span><span style="font-family:'Microsoft JhengHei'">密碼錯誤</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('cancelLoginBtn').addEventListener('click', () =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginModal').classList.remove('active');</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('loginPassword').value = '';</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('newScheduleBtn').addEventListener('click', openScheduleModal);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('cancelScheduleBtn').addEventListener('click', closeScheduleModal);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('scheduleForm').addEventListener('submit', saveSchedule);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('quickCopyBtn').addEventListener('click', quickCopy);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('clearBtn').addEventListener('click', clearWeek);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('queryBtn').addEventListener('click', openQueryModal);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('cancelQueryBtn').addEventListener('click', closeQueryModal);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('cancelConfirmBtn').addEventListener('click', closeConfirmModal);</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('confirmActionBtn').addEventListener('click', executeConfirm);</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('prevYearBtn').addEventListener('click', () =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">currentWeekOffset -= 52;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateDateDisplay();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateStats();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateQuickCopyButton();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">closeQueryModal();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('prevMonthBtn').addEventListener('click', () =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">currentWeekOffset -= 4;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateDateDisplay();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateStats();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateQuickCopyButton();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">closeQueryModal();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('nextMonthBtn').addEventListener('click', () =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">currentWeekOffset += 4;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateDateDisplay();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateStats();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateQuickCopyButton();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">closeQueryModal();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.getElementById('nextYearBtn').addEventListener('click', () =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">currentWeekOffset += 52;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateDateDisplay();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateStats();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateQuickCopyButton();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">closeQueryModal();</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.querySelectorAll('.nav-tab').forEach(tab =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">tab.addEventListener('click', () =&gt; {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.querySelectorAll('.nav-tab').forEach(t =&gt; t.classList.remove('active'));</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">tab.classList.add('active');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">currentTab = tab.dataset.tab;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderSchedule();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.querySelectorAll('.font-btn').forEach(btn =&gt; {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">btn.addEventListener('click', () =&gt; {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">document.querySelectorAll('.font-btn').forEach(b =&gt; b.classList.remove('active'));</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">btn.classList.add('active');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const size = btn.dataset.size;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">const container = document.getElementById('appContainer');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">container.classList.remove('font-small', 'font-large');</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (size === 'small') {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">container.classList.add('font-small');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">} else if (size === 'large') {</span></p><p style="text-indent:63pt; font-size:10.5pt"><span style="font-family:'Courier New'">container.classList.add('font-large');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">});</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">async function init() {</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">renderEmptySchedule();</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">updateDateDisplay();</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">const initResult = await window.dataSdk.init(dataHandler);</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">if (!initResult.isOk) {</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">showToast('❌ </span><span style="font-family:'Microsoft JhengHei'">系統初始化失敗</span><span style="font-family:'Courier New'">');</span></p><p style="text-indent:50.4pt; font-size:10.5pt"><span style="font-family:'Courier New'">return;</span></p><p style="text-indent:37.8pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">}</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'; -aw-import:ignore">&#xa0;</span></p><p style="text-indent:25.2pt; font-size:10.5pt"><span style="font-family:'Courier New'">init();</span></p><p style="text-indent:12.6pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/script&gt;</span></p><p style="text-indent:6.3pt; font-size:10.5pt"><span style="font-family:'Courier New'">&lt;script&gt;(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9d23b67841d64a97',t:'MTc3MTgxODE0MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&amp;&amp;(document.onreadystatechange=e,c())}}}})();&lt;/script&gt;&lt;/body&gt;</span></p><p style="font-size:10.5pt"><span style="font-family:'Courier New'">&lt;/html&gt;</span></p></div></body></html>